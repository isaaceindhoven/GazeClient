<!DOCTYPE html>
<html class="h-full w-full" lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js" defer></script>
    
</head>
<body class="flex h-full w-full" x-data="main()" x-init="init()">

    <div class="flex flex-col w-1/3 flex-shrink-0 bg-gray-100 p-4 border-r border-gray-300">

        <div class="flex flex-col items-start">

            <div class="flex items-center mb-3">
                <label class="w-28">Connected:</label>
                <div 
                    class="w-3 h-3 rounded-full" 
                    :class="{
                        'bg-red-500' : !connected,
                        'bg-green-500' : connected,
                    }">
                </div>
            </div>

            <div class="flex items-center mb-3">
                <label class="w-28">Topics:</label>
                <input id="topics" class="px-2 py-1 rounded" type="text" value='["ProductCreated"]'>
            </div>

            <div @click="subscribe()" class="ml-28 bg-purple-500 px-2 py-1 hover:bg-purple-600 text-white rounded cursor-pointer">
                Subscribe
            </div>

        </div>

        <div class="bg-gray-300 w-full my-6" style="height: 1px;"></div>

        <div class="flex flex-col items-start">

            <div class="flex items-center mb-3">
                <label class="w-28">Topic:</label>
                <input id="emit-topic" class="px-2 py-1 rounded" type="text" value="ProductCreated">
            </div>

            <div class="flex items-start mb-3">
                <label class="w-28">Payload:</label>
                <pre 
                    id="emit-payload" 
                    class="bg-gray-800 px-2 py-1 rounded text-white text-sm"
                    x-text="
                        JSON.stringify({
                            'id' : 1,
                            'name' : 'Gucci Shirt XL',
                            'price' : 10,
                            'meta' : {
                                'stock' : 4
                            },
                        }, null, 2);
                    " 
                    contenteditable="true">
                </pre>
            </div>

            <div class="flex items-center mb-3">
                <label class="w-28">Roles:</label>
                <input id="emit-roles" class="px-2 py-1 rounded" type="text" value='["admin"]'>
            </div>

            <div @click="emit()" class="ml-28 bg-purple-500 px-2 py-1 hover:bg-purple-600 text-white rounded cursor-pointer">
                Emit
            </div>

        </div>
    </div>

    <div class="flex flex-col w-full bg-gray-100 p-4 border-r border-gray-300">
        <template x-for="k in Object.keys(listeners)" :key="k">
            <div class="relative border rounded p-3 bg-blue-100 text-blue-600 mb-4">
                <div class="flex items-center">
                    <div class="font-semibold" x-text="JSON.stringify(listeners[k].meta.topics)"></div>
                </div>
                <div x-text="JSON.stringify(listeners[k].recieved)"></div>
            </div>
        </template>
    </div>

    <script src="./main.js"></script>
</body>
</html>